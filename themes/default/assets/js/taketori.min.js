var TaketoriDblClickAlert={"ja-jp":"\uFEFF\u7E26\u66F8\u304D\u5316\u3057\u305F\u3044\u90E8\u5206\u3092\u30C0\u30D6\u30EB\u30AF\u30EA\u30C3\u30AF\u3057\u3066\u304F\u3060\u3055\u3044\u3002","zh-tw":"\u9ede\u5169\u4e0b\u4ee5\u5207\u63db\u5230\u76f4\u6392\u986f\u793a\u3002","zh-cn":"Double click to make text vertical.","ko-kr":"Double click to make text vertical."};var TaketoriDefaultLang=(document.getElementsByTagName("html")[0]&&document.getElementsByTagName("html")[0].lang)?(document.getElementsByTagName("html")[0].lang.search(/tw/i)!=-1)?"zh-tw":"ja-jp":"ja-jp";var TaketoriTool=function(){};TaketoriTool.prototype={element:function(a){if(arguments.length>1){a=Array.prototype.slice.call(arguments)}this.elements=new Array();return this.appendElement(a)},list:function(){return(this.elements)?this.elements:[]},appendElement:function(b){if(arguments.length>1){b=Array.prototype.slice.call(arguments)}if(!b){return this}if(!this.elements){this.elements=new Array()}if(b.constructor==Array){for(var d=0;d<b.length;d++){this.appendElement(b[d])}}else{if(typeof b=="object"){if(!this.isIncluded(b)){this.elements[this.elements.length]=b}}else{if(typeof b=="string"){if(b.match(/^(\w+)\.([\w\-]+)$/)){var f=RegExp.$1.toLowerCase();var a=RegExp.$2;var c=new Array();if(typeof document.getElementsByClassName=="function"){c=document.getElementsByClassName(a);for(var d=0;d<c.length;d++){if(c[d].tagName.toLowerCase()==f&&!this.isIncluded(c[d])){this.elements[this.elements.length]=c[d]}}}if(typeof document.getElementsByClassName!="function"||c.length==0){c=document.getElementsByTagName(f);var e=new RegExp("(^|\\s)"+a+"(?![\\w\\-])");for(var d=0;d<c.length;d++){if(c[d].className.search(e)!=-1&&!this.isIncluded(c[d])){this.elements[this.elements.length]=c[d]}}}}else{b=document.getElementById(b.replace("#",""));if(b&&!this.isIncluded(b)){this.elements[this.elements.length]=b}}}}}return this},isIncluded:function(b){for(var a=0;a<this.elements.length;a++){if(this.elements[a]==b){return true}}return false},removeClassName:function(a){return this.replaceClassName(a,"","ig")},replaceClassName:function(a,d,b){if(this.elements&&a!=null&&a!=""){var e=new RegExp("(^|\\s)"+a+"(?![\\w\\-])",b);if(d==null){d=""}for(var c=0;c<this.elements.length;c++){if(this.elements[c].className!=null){this.elements[c].className=this.elements[c].className.replace(e,d)}}}return this},addClassName:function(a){if(this.elements&&a!=null&&a!=""){var c=new RegExp("(^|\\s)"+a+"(?![\\w\\-])");for(var b=0;b<this.elements.length;b++){if(this.elements[b].className==null||this.elements[b].className==""){this.elements[b].className=a}else{if(this.elements[b].className.search(c)==-1){this.elements[b].className+=" "+a}}}}return this},addEventListener:function(d,b,a){if(a==null){a=false}if(this.elements){for(var c=0;c<this.elements.length;c++){if(typeof this.elements[c].addEventListener=="function"){this.elements[c].addEventListener(d,b,a)}else{if(typeof this.elements[c].attachEvent=="object"){this.elements[c].attachEvent("on"+d,b)}}}}return b},removeEventListener:function(d,b,a){if(this.elements){for(var c=0;c<this.elements.length;c++){if(typeof this.elements[c].removeEventListener=="function"){this.elements[c].removeEventListener(d,b,a)}else{if(this.elements[c].detachEvent){this.elements[c].detachEvent("on"+d,b)}}}}},stopPropagation:function(a){if(a.stopPropagation){a.stopPropagation()}else{event.cancelBubble=true}},preventDefault:function(a){if(a.preventDefault){a.preventDefault()}else{event.returnValue=false}}};var Taketori=function(){};Taketori.prototype={isMSIE:((document.documentMode)?document.documentMode:(navigator.appVersion.search(/MSIE/)!=-1)?5:0),isWritingModeReady:((navigator.appVersion.search(/MSIE/)!=-1||document.documentMode||typeof(document.createElement("div")).style.MozWritingMode!="undefined"||(typeof(document.createElement("div")).style.webkitWritingMode!="undefined"&&(!window.devicePixelRatio||window.devicePixelRatio<2||navigator.userAgent.search(/Chrome\/([0-9]+)/)==-1||parseInt(RegExp.$1)>30))||typeof(document.createElement("div")).style.OWritingMode!="undefined")?true:false),isMultiColumnReady:((typeof(document.createElement("div")).style.MozColumnWidth!="undefined"||typeof(document.createElement("div")).style.webkitColumnWidth!="undefined"||(typeof(document.createElement("div")).style.webkitWritingMode!="undefined"&&typeof(document.createElement("div")).style.webkitColumnWidth!="undefined")||typeof(document.createElement("div")).style.OColumnWidth!="undefined"||typeof(document.createElement("div")).style.msColumnWidth!="undefined"||typeof(document.createElement("div")).style.columnWidth!="undefined")?true:false),isLegacy:((navigator.appVersion.search(/MSIE/)!=-1||typeof(document.createElement("div")).style.MozTransform!="undefined"||typeof(document.createElement("div")).style.webkitTransform!="undefined"||typeof(document.createElement("div")).style.OTransform!="undefined"||typeof(document.createElement("div")).style.transform!="undefined")?false:true),isTextEmphasisReady:((typeof(document.createElement("div")).style.MozTextEmphasisStyle!="undefined"||typeof(document.createElement("div")).style.webkitTextEmphasisStyle!="undefined"||typeof(document.createElement("div")).style.OTextEmphasisStyle!="undefined"||typeof(document.createElement("div")).style.msTextEmphasisStyle!="undefined"||typeof(document.createElement("div")).style.textEmphasisStyle!="undefined")?true:false),supportTouch:((((!window.navigator.msPointerEnabled&&!window.navigator.pointerEnabled)||navigator.userAgent.search(/iphone|ipad|android/i)!=-1)&&("createTouch" in document||"ontouchstart" in document))?true:false),document:(new TaketoriTool()),importCSS:function(){var a=false;var g=false;var e=document.getElementsByTagName("link");for(var c=0;c<e.length;c++){if(e[c].href!=null&&e[c].href.search(/taketori\.css$/)!=-1){a=true}}if(a){return true}if(this.config.cssPath==null||this.config.cssPath=="auto"){var f=document.getElementsByTagName("script");for(var c=0;c<f.length;c++){if(f[c].src!=null&&f[c].src.search(/taketori\.js$/)!=-1){this.config.cssPath=f[c].src.replace("taketori.js","");break}}}var b=document.getElementsByTagName("head")[0];if(b){var d;d=document.createElement("link");d.setAttribute("rel","stylesheet");d.setAttribute("type","text/css");d.setAttribute("href","themes/default/assets/css/taketori.css");b.appendChild(d)}else{document.write('<link rel="stylesheet" type="text/css" href="taketori.css" />')}},setTemporaryCSS:function(a){if(!this.temporaryStyle){this.temporaryStyle=document.createElement("style");this.temporaryStyle.setAttribute("type","text/css");document.getElementsByTagName("head")[0].appendChild(this.temporaryStyle)}this.temporaryStyle.appendChild(document.createTextNode(a))},removeTemporaryCSS:function(){if(this.temporaryStyle){document.getElementsByTagName("head")[0].removeChild(this.temporaryStyle);this.temporaryStyle=null}},init:function(){if(!this.windowWidth){var c=this;this.document.element(window).addEventListener("resize",function(){if(c.resizeTimer){clearTimeout(c.resizeTimer)}c.resizeTimer=setTimeout(function(){c.refresh()},500)})}this.windowWidth=((self.innerWidth)?self.innerWidth:(document.compatMode!=null&&document.compatMode!="BackCompat")?self.document.documentElement.clientWidth:self.document.body.clientWidth);this.windowHeight=((self.innerHeight)?self.innerHeight:(document.compatMode!=null&&document.compatMode!="BackCompat")?self.document.documentElement.clientHeight:self.document.body.clientHeight);if(!this.isMSIE&&this.rubyDisabled==null){if(!!window.opera){this.rubyDisabled=true}else{var a=document.createElement("ruby");var b=this.getStyle(a).display;this.rubyDisabled=(b=="block")?true:false}}},set:function(a){if(this.isLegacy){return this}if(!this.config){this.config={}}if(a!=null){this.merge(this.config,a)}if(this.config.lang){this.config.lang=this.config.lang.toLowerCase()}return this},merge:function(c,a){if(!c){c={}}if(a!=null){for(var b in a){if(a[b]!=null){if(a[b].constructor==Array){this.merge(c[b],a[b])}else{if(typeof a[b]=="string"||typeof a[b]=="number"||typeof a[b]=="boolean"){c[b]=a[b]}}}}}return c},element:function(a){if(this.isLegacy){return this}if(arguments.length>1){a=Array.prototype.slice.call(arguments)}if(!this.config.elements){this.config.elements=new Array()}if(a&&a.constructor==Array){for(var b=0;b<a.length;b++){this.config.elements[this.config.elements.length]=a[b]}}else{if(a){this.config.elements[this.config.elements.length]=a}}return this},reset:function(a){this.config=null;this.set(a)},japaneseReadableElements:function(c){var a=new Array();var g=new Array();var h=document.getElementsByTagName("p");for(var b=0;b<h.length;b++){g[g.length]=h[b]}h=document.getElementsByTagName("br");for(var b=0;b<h.length;b++){g[g.length]=h[b]}for(var b=0;b<g.length;b++){var d=this.lookUpBlockElements(g[b],a);if(d!=null&&!this.isCountedElement(a,d)){var j=d.innerHTML;var f=0;j.replace(/\u3002/g,function(){f++}).replace(/\u3001/g,function(){f+=0.5});a[a.length]={element:d,readabilityScore:f}}}if(a.length>0){a=a.sort(function(i,k){return k.readabilityScore-i.readabilityScore});var e=new Array();for(var b=0;b<a.length;b++){if(!this.isVerticalTextElement(a[b].element)&&(!c||c<a[b].readabilityScore)){e[e.length]=a[b].element}}return e}else{return[document.body]}},isVerticalTextElement:function(a){var b=this.getStyle(a);return((navigator.appVersion.search(/MSIE/)!=-1&&typeof b.writingMode=="string"&&(b.writingMode.toLowerCase()=="tb-rl"||b.writingMode.toLowerCase()=="vertical-rl"))||(typeof b.MozWritingMode=="string"&&b.MozWritingMode.toLowerCase()=="vertical-rl")||(typeof b.webkitWritingMode=="string"&&b.webkitWritingMode.toLowerCase()=="vertical-rl")||(typeof b.OWritingMode=="string"&&b.OWritingMode.toLowerCase()=="vertical-rl")||(typeof b.writingMode=="string"&&b.writingMode.toLowerCase()=="vertical-rl"))?true:false},isCountedElement:function(b,a){for(var c=0;c<b.length;c++){if(b[c].element==a){return true}}return false},lookUpBlockElements:function(b){var a=null;while(b){var c=b.tagName.toLowerCase();if(c=="div"||c=="td"||c=="th"||c=="dd"||c=="section"||c=="article"||c=="body"){if(b.taketori||!a){a=b}if(c=="body"){break}}b=b.parentNode}return a},isIncludedIn:function(a,c){if(a&&a.constructor==Array){for(var b=0;b<a.length;b++){if(a[b]==c){return true}}}return false},escapeHTML:function(b){var a=document.createElement("div");var c=document.createTextNode(b);a.appendChild(c);return a.innerHTML},unescapeHTML:function(a){return(a==null)?"":a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")},getCookie:function(f){var b=new Array();var a=document.cookie.split(/;\s*/);for(var d=0;d<a.length;d++){if(a[d]!=""){var c=a[d].indexOf("=");if(c>=0){var e=a[d].substring(0,c);var g=a[d].substring(c+1,a[d].length);b[e]=g}}}return(f!=null&&b[f]!=null)?b[f]:""},setCookie:function(b,c,a){if(!a){if(this.config.cookieExpires){a=this.config.cookieExpires}else{a=new Date();a.setTime(a.getTime()+86400000000)}}document.cookie=b+"="+c+"; expires="+a.toGMTString()+";"+((this.config.cookieDomain!=null&&this.config.cookieDomain!="")?" domain="+this.config.cookieDomain+";":"")+((this.config.cookiePath!=null&&this.config.cookiePath!="")?" path="+this.config.cookiePath:"")},deleteCookie:function(a){this.setCookie(a,"",new Date(70,0,1,0,0,1))},setOnLoad:function(a){if(this.isLegacy){return this}if(typeof window.addEventListener=="function"){window.addEventListener("load",a,false)}else{if(typeof window.attachEvent=="object"){window.attachEvent("onload",((!this.isMultiColumnReady)?function(){setTimeout(a,600)}:a))}}return this},getStyle:function(b){if(b.currentStyle){return b.currentStyle}else{var d=document.defaultView.getComputedStyle(b,null);var a=document.createElement("div");if(d.length){for(var c=0;c<d.length;c++){a.style.setProperty(d[c],d.getPropertyValue(d[c]),"")}for(var c=0;c<b.style.length;c++){a.style.setProperty(b.style[c],b.style.getPropertyValue(b.style[c]),"")}}else{a.style.cssText=d.cssText+b.style.cssText}return a.style}},counterClockwiseRotatedOuterHTML:function(d,l,b){var n;var f=(l.display!="inline"||(l.cssFloat&&l.cssFloat!="none")||(l.styleFloat&&l.styleFloat!="none"))?true:false;var m=false;if(!l){l=this.getStyle(d)}if(b){n=document.createElement("div")}else{n=d.cloneNode(true)}if(this.isWritingModeReady&&b){if(l.width&&l.width.search(/\d+\.?\d*(px|em)/i)!=-1&&parseInt(l.width)>0&&l.height&&l.height.search(/\d+\.?\d*(px|em)/i)!=-1&&parseInt(l.height)>0){if(d.currentStyle||(l.cssFloat&&l.cssFloat!="none")||(l.display=="inline-block")){m=true}else{n.style.width="auto";n.style.height="auto"}}else{if((l.width&&l.width.search(/\d+\.?\d*%/)!=-1)||(l.height&&l.height.search(/\d+\.?\d*%/)!=-1)){n.style.width=(l.height&&l.height.search(/\d+\.?\d*%/)!=-1)?l.height:"auto";n.style.height=(l.width&&l.width.search(/\d+\.?\d*%/)!=-1)?l.width:"auto"}else{if(l.width=="0px"){n.style.width="auto"}if(l.height=="0px"){n.style.height="auto"}}}}if(!this.isWritingModeReady||m||(this.isWritingModeReady&&!b)){var i=0;var g=0;var j=false;if(this.isWritingModeReady){i=this.getMarginSize([l.paddingLeft,l.paddingRight,l.borderLeftWidth,l.borderRightWidth]);g=this.getMarginSize([l.paddingTop,l.paddingBottom,l.borderTopWidth,l.borderBottomWidth]);j=true}else{i=this.getMarginSize([l.paddingTop,l.paddingBottom,l.borderTopWidth,l.borderBottomWidth]);g=this.getMarginSize([l.paddingLeft,l.paddingRight,l.borderLeftWidth,l.borderRightWidth])}var o=(!isNaN(parseInt(l.width))&&parseInt(l.width)>0)?parseInt(l.width):(d.width)?d.width:(d.offsetWidth)?d.offsetWidth-((j)?i:g):null;var e=(!isNaN(parseInt(l.height))&&parseInt(l.height)>0)?parseInt(l.height):(d.height)?d.height:(d.offsetHeight)?d.offsetHeight-((j)?g:i):null;var k=false;if(!o||!e){this.makeClipboard(this.process.target,true);this.clipboard.appendChild(n);o=(n.offsetWidth)?n.offsetWidth-((j)?i:g):n.clientWidth;e=(n.offsetHeight)?n.offsetHeight-((j)?g:i):n.clientHeight;this.clipboard.removeChild(n)}if(!isNaN(o)&&!isNaN(e)){o+=i;e+=g;if(e>this.process.config.height){o=parseInt(o*this.process.config.height/e);e=this.process.config.height;k=true}if(o>this.process.config.width){e=parseInt(e*this.process.config.width/o);o=this.process.config.width;k=true}if(k||m){var c=o-i;var a=e-g;if(m){if(d.currentStyle||(l.display=="inline-block")){n.width=a;n.style.width=a+"px"}else{n.style.width="auto"}n.height=c;n.style.height=c+"px"}else{n.width=c;n.height=a;n.style.width=c+"px";n.style.height=a+"px";if(k&&f){n.style.overflow="auto"}}}}}n.style.borderTopWidth=l.borderLeftWidth||0;n.style.borderRightWidth=l.borderTopWidth||0;n.style.borderBottomWidth=l.borderRightWidth||0;n.style.borderLeftWidth=l.borderBottomWidth||0;n.style.borderTopColor=l.borderLeftColor||"";n.style.borderRightColor=l.borderTopColor||"";n.style.borderBottomColor=l.borderRightColor||"";n.style.borderLeftColor=l.borderBottomColor||"";n.style.borderTopStyle=l.borderLeftStyle||"none";n.style.borderRightStyle=l.borderTopStyle||"none";n.style.borderBottomStyle=l.borderRightStyle||"none";n.style.borderLeftStyle=l.borderBottomStyle||"none";if(f||!b||(this.isWritingModeReady&&(!this.isMSIE||this.isMSIE<8))){n.style.paddingTop=l.paddingLeft||0;n.style.paddingRight=l.paddingTop||0;n.style.paddingBottom=l.paddingRight||0;n.style.paddingLeft=l.paddingBottom||0}if(this.isWritingModeReady){if(f&&b){n.style.overflowX=(l.overflowY)?l.overflowY:"visible";n.style.overflowY=(l.overflowX)?l.overflowX:"visible"}if(l.backgroundPositionX||l.backgroundPositionY){n.style.backgroundPositionX=(l.backgroundPositionY)?(l.backgroundPositionY=="top")?"left":(l.backgroundPositionY=="bottom")?"right":l.backgroundPositionY:"50%";n.style.backgroundPositionY=(l.backgroundPositionX)?(l.backgroundPositionX=="left")?"top":(l.backgroundPositionX=="right")?"bottom":l.backgroundPositionX:"50%"}else{if(l.backgroundPosition&&l.backgroundPosition.search(/(\S+)\s+(\S)/)!=-1){n.style.backgroundPosition=RegExp.$2+" "+RegExp.$1+";"}}if(f||!b||!this.isMSIE||this.isMSIE<8){n.style.marginTop=l.marginLeft||0;n.style.marginRight=l.marginTop||0;n.style.marginBottom=l.marginRight||0;n.style.marginLeft=l.marginBottom||0}}else{n.style.marginTop=parseInt(((l.marginTop&&l.marginTop!="auto")?parseInt(l.marginTop):0)+((o-e)/2))+"px";n.style.marginRight=parseInt(((l.marginRight&&l.marginRight!="auto")?parseInt(l.marginRight):0)+((e-o)/2))+"px";n.style.marginBottom=parseInt(((l.marginBottom&&l.marginBottom!="auto")?parseInt(l.marginBottom):0)+((o-e)/2))+"px";n.style.marginLeft=parseInt(((l.marginLeft&&l.marginLeft!="auto")?parseInt(l.marginLeft):0)+((e-o)/2))+"px";if(l.backgroundPosition&&l.backgroundPosition.search(/(\S+)\s+(\S)/)!=-1){n.style.backgroundPosition=RegExp.$2+" "+RegExp.$1+";"}}return(b)?n.style.cssText+";"+d.style.cssText:this.outerHTML(n)},outerHTML:function(b){if(!b){return""}var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML},rotatedBlockAdditionalCSSText:function(d,b,a,c){if(a==null){a=0}if(this.isWritingModeReady){return"width:"+b+"px;height:"+d+"px;"+((a)?((this.isMSIE&&this.isMSIE==9)?(!c)?"padding-right:":"margin-right:":(!c)?"padding-bottom:":"margin-bottom:")+a+"px;":"")+((!c)?"position:relative;overflow:auto;overflow-x:auto;overflow-y:hidden;":"")}else{return"width:"+d+"px;height:"+b+"px;margin-top:-"+b+"px;margin-right:"+(b-d-a)+"px;margin-bottom:"+(d+a)+"px;margin-left:0;"+((!c)?"padding-right:"+a+"px;overflow:auto;overflow-x:visible;overflow-y:auto;":"")}},toVertical:function(k,a){if(this.isLegacy){return this}var g=this;if(k==null||k){this.setOnLoad(function(){g.toVertical(false)})}else{this.importCSS();var e=false;var f=false;if(!this.targetElements){if(!this.config.elements||this.config.elements[0]=="=auto"){this.targetElements=this.japaneseReadableElements((this.config.minScore==null)?3:this.config.minScore);this.config.togglable=false;e=true}else{if(this.config.elements[0]=="=dblclick"){f=e=true}else{var h=this.document.element(this.config.elements).list();this.targetElements=new Array();for(var d=0;d<h.length;d++){if(!this.isVerticalTextElement(h[d])){this.targetElements[this.targetElements.length]=h[d]}}}}}var c=(this.supportTouch)?"touchstart":"dblclick";if(e){if(!this.toggleEventAttached){this.document.element(document.body).addEventListener(c,function(l){l=l||event;if(g.supportTouch&&l.touches){var i=(g.dblClickTimer)?true:false;l=l.touches[0];if(i){clearTimeout(g.dblClickTimer);delete g.dblClickTimer;if(Math.abs(g.touchX-l.pageX)>50||Math.abs(g.touchY-l.pageY)>50){i=false}}g.touchX=l.pageX;g.touchY=l.pageY;if(!i){g.dblClickTimer=setTimeout(function(){if(g.dblClickTimer){delete g.dblClickTimer}if(g.touchX){delete g.touchX}if(g.touchY){delete g.touchY}},500);return}}g.toggle(g.lookUpBlockElements(l.target||l.srcElement));g.document.stopPropagation(l);g.document.preventDefault(l)});this.toggleEventAttached=true}if(f){var j=navigator.browserLanguage||navigator.language||navigator.userLanguage;j=(j.search(/tw/i)!=-1)?"zh-tw":(j.search(/(zh|cn)/i)!=-1)?"zh-cn":(j.search(/(ko|kr)/i)!=-1)?"ko-kr":"ja-jp";alert(TaketoriDblClickAlert[j]);return this}}if(this.ttbDisabled==null){this.ttbDisabled=(this.getCookie("TTB_DISABLED")=="true")?true:false}if(this.config.togglable){if(!this.config.cookieDomain){this.config.cookieDomain=document.domain}if(!this.config.cookiePath){this.config.cookiePath="/"}for(var d=0;d<this.targetElements.length;d++){var b=this.targetElements[d];if(!b.taketori){b.taketori={}}if(!b.taketori.toggleEventAttached){this.document.element(b).addEventListener(c,function(l){l=l||event;if(g.supportTouch&&l.touches){var i=(b.taketori.dblClickTimer)?true:false;l=l.touches[0];if(i){clearTimeout(b.taketori.dblClickTimer);delete b.taketori.dblClickTimer;if(Math.abs(b.taketori.touchX-l.pageX)>50||Math.abs(b.taketori.touchY-l.pageY)>50){i=false}}b.taketori.touchX=l.pageX;b.taketori.touchY=l.pageY;if(!i){b.taketori.dblClickTimer=setTimeout(function(){if(b.taketori.dblClickTimer){delete b.taketori.dblClickTimer}if(b.taketori.touchX){delete b.taketori.touchX}if(b.taketori.touchY){delete b.taketori.touchY}},500);return}}g.document.stopPropagation(l);g.document.preventDefault(l);if(g.ttbDisabled){g.deleteCookie("TTB_DISABLED");g.ttbDisabled=false}else{g.setCookie("TTB_DISABLED","true");g.ttbDisabled=true}g.toVertical(false)});b.taketori.toggleEventAttached=true}this.toggle(b,this.ttbDisabled,true)}}else{if(!this.ttbDisabled){for(var d=0;d<this.targetElements.length;d++){this.make(this.targetElements[d])}}}}return this},configClone:function(b){if(!b){return{}}var a={};var c=["width","height","fontFamily","maxHeight","multiColumnEnabled","gap","contentWidth","contentHeight","onbreak","classNameImported","lang"];for(var d=0;d<c.length;d++){if(b[c[d]]!=null){a[c[d]]=b[c[d]]}}return a},toggleAll:function(){if(this.isLegacy){return this}if(!this.config.cookieDomain){this.config.cookieDomain=document.domain}if(!this.config.cookiePath){this.config.cookiePath="/"}if(this.ttbDisabled){this.deleteCookie("TTB_DISABLED");this.ttbDisabled=false}else{this.setCookie("TTB_DISABLED","true");this.ttbDisabled=true}if(this.targetElements){for(var b=0;b<this.targetElements.length;b++){var a=this.targetElements[b];this.toggle(a,this.ttbDisabled,true)}}return this},clearAll:function(){if(this.isLegacy){return this}if(!this.config.cookieDomain){this.config.cookieDomain=document.domain}if(!this.config.cookiePath){this.config.cookiePath="/"}if(!this.ttbDisabled){this.setCookie("TTB_DISABLED","true");this.ttbDisabled=true}if(this.targetElements){for(var b=0;b<this.targetElements.length;b++){var a=this.targetElements[b];this.toggle(a,true,true,true)}}return this},appendTarget:function(a){if(this.isVerticalTextElement(a)){return}if(!this.targetElements){this.targetElements=new Array(a)}else{if(!this.isIncludedIn(this.targetElements,a)){this.targetElements[this.targetElements.length]=a}}},removeTarget:function(a){if(this.targetElements){var c=new Array();for(var b=0;b<this.targetElements.length;b++){if(this.targetElements[b]!=a){c[c.length]=this.targetElements[b]}}this.targetElements=c}},makeClipboard:function(b,c){if(!c&&!this.process.isBreakable){return}if(this.clipboard&&this.clipboard.parentNode!=b){this.removeClipboard()}if(!this.clipboard){this.clipboard=document.createElement("div");this.clipboard.style.position="absolute";b.appendChild(this.clipboard);var a=(this.windowWidth>this.windowHeight)?this.windowWidth:this.windowHeight;this.clipboard.style.top="-"+(a+100)+"px";this.clipboard.style.left="-"+(a+100)+"px";this.clipboard.style.width=a+"px";this.clipboard.style.height=a+"px";this.clipboard.style.overflow="auto"}},removeClipboard:function(){if(this.temporaryContent){this.temporaryContent.parentNode.removeChild(this.temporaryContent)}if(this.clipboard){this.clipboard.parentNode.removeChild(this.clipboard)}this.clipboard=null;this.temporaryContent=null},toPx:function(d,a,b,c){return(!d)?0:(b)?((d.search(/(\d+\.\d+)/)!=-1)?parseInt(RegExp.$1*a):parseInt(1.5*a)):(d.search(/\d+\.?\d*em/i)!=-1)?parseInt(parseFloat(d)*a):(d.search(/\d+\.?\d*%/)!=-1)?parseInt(parseFloat(d)*((c)?c:a)/100):(d.search(/\d/)!=-1)?parseInt(d):d},getFontSize:function(b){if(!isNaN(b)||b.search(/\d+px/)!=-1){return parseInt(b)}else{var a=(this.getStyle(document.body)).fontSize;a=(a.search(/\d+\.?\d*(em|%)/)!=-1)?this.toPx(a,16):parseInt(a);b=this.toPx(b,a);return(b>0)?b:16}},setCurrentConfig:function(e,d){if(!d){d=this.configClone(this.config)}if(!d.classNameImported){var a=e.className;if(a){var b=["width","height","fontFamily","maxHeight","multiColumnEnabled","gap","contentWidth","contentHeight","lang"];for(var j=0;j<b.length;j++){var m=new RegExp("(^|\\s)taketori-"+b[j]+"-([\\w\\.\\-\\%]+)(?![\\w\\-])","i");if(a.search(m)!=-1){d[b[j]]=RegExp.$2}}}d.classNameImported=true}d.lang=(d.lang)?d.lang.toLowerCase():TaketoriDefaultLang;d.ja=null;d.zh=null;if(d.lang=="ja-jp"){d.ja=true}else{if(d.lang.search(/^zh-/)!=-1){d.zh=true}}this.init();var c=this.getStyle(e);var f=this.getFontSize(c.fontSize);this.process={target:e,done:false,isMultiColumnEnabled:false,noCJK:0,latin:0,width:0,columnCount:0,openTagsHTML:"",listStart:[],listStyleType:[],currentStyle:{},openTags:[],closeTags:[],columnHTML:"",content:"",config:{}};if((typeof d.multiColumnEnabled=="boolean"&&d.multiColumnEnabled)||(this.isMultiColumnReady&&d.multiColumnEnabled&&d.multiColumnEnabled=="auto")){this.process.config.multiColumnEnabled=true}if(this.isMultiColumnReady&&this.process.config.multiColumnEnabled){this.process.isMultiColumnEnabled=true}if((!this.isMultiColumnReady&&this.process.config.multiColumnEnabled)||(d.contentHeight&&d.contentWidth)){this.process.isBreakable=true}var n=this.getElementWidth(e,c);if(d.contentWidth){this.process.config.contentWidth=this.toPx(d.contentWidth,f,false,n)}if(d.contentHeight){this.process.config.contentHeight=this.toPx(d.contentHeight,f,false,n)}this.process.config.width=(d.width)?this.toPx(d.width,f,false,n):(this.process.config.contentWidth!=null)?this.process.config.contentWidth:n;this.process.config.gap=(d.gap!=null)?this.toPx(d.gap,f):f*2;if(d.height==null){if(!d.maxHeight){d.maxHeight="36em"}var k=this.toPx(d.maxHeight,f);var o=(this.process.config.contentHeight)?this.process.config.contentHeight:this.windowHeight;if(this.process.config.multiColumnEnabled){var l=Math.ceil(o/(k+this.process.config.gap));this.process.config.height=parseInt((o-40)/l)-this.process.config.gap;if(this.process.config.contentHeight){this.process.config.columnCount=l}}else{o=o-this.process.config.gap-18;this.process.config.height=(o>k)?k:o}}else{if(this.process.config.contentHeight&&this.process.config.multiColumnEnabled){var g=this.toPx(d.height,f);this.process.config.columnCount=Math.ceil(this.process.config.contentHeight/(g+this.process.config.gap));this.process.config.height=parseInt((this.process.config.contentHeight+this.process.config.gap)/this.process.config.columnCount)-this.process.config.gap}else{if(d.height&&d.height=="width"){this.process.config.height=this.process.config.width}else{if(!this.process.config.multiColumnEnabled){this.process.config.height=this.process.config.contentHeight||this.toPx(d.height,f)}else{this.process.config.height=this.toPx(d.height,f)}}}}this.process.currentConfig=d;return this},getElementWidth:function(a,b){return((a.offsetWidth)?a.offsetWidth:a.scrollWidth)-this.getMarginSize([b.paddingLeft,b.paddingRight,b.borderLeftWidth,b.borderRightWidth])},getMarginSize:function(c){var b=0;for(var a=0;a<c.length;a++){if(c[a]&&!isNaN(parseInt(c[a]))){b+=parseInt(c[a])}}return b},getWidth:function(a){var b=0;this.setTaketoriClassName(this.clipboard);if(!this.temporaryContent){this.temporaryContent=document.createElement("div");this.setTemporaryContentStyle();this.clipboard.appendChild(this.temporaryContent)}this.temporaryContent.innerHTML=a;this.process.width=this.getTemporaryContentWidth();this.clipboard.className="";return this.process.width},setTemporaryContentStyle:function(){this.temporaryContent.className="taketori-col";if(this.isWritingModeReady){this.temporaryContent.style.height=this.process.config.height+"px";this.temporaryContent.style.width="16px"}else{this.temporaryContent.style.overflow="auto";this.temporaryContent.style.width=this.process.config.height+"px"}},getTemporaryContentWidth:function(){return(this.isWritingModeReady)?(this.temporaryContent.scrollWidth||this.temporaryContent.clientWidth||this.temporaryContent.offsetWidth):(this.temporaryContent.scrollHeight||this.temporaryContent.clientHeight||this.temporaryContent.offsetHeight)},hasToBreak:function(b){if(!this.temporaryContent){this.temporaryContent=document.createElement("div");this.clipboard.appendChild(this.temporaryContent)}var d=0;var e=0;var c=false;this.temporaryContent.className="taketori-col";this.temporaryContent.style.overflow="auto";this.setTaketoriClassName(this.clipboard);if(this.process.config.columnCount&&this.process.config.columnCount>1){var a=this.process.config.width*this.process.config.columnCount;if(this.process.width+50<a){this.setTemporaryContentStyle();this.temporaryContent.innerHTML=b;this.process.width=this.getTemporaryContentWidth()}if(this.process.width+50>=a){d=this.getMultiColumnWidth(b);c=(d>this.process.config.contentHeight)?true:false}}else{if(this.isWritingModeReady){this.temporaryContent.style.height=this.process.config.contentHeight+"px";this.temporaryContent.innerHTML=b;this.process.width=this.temporaryContent.scrollWidth||this.temporaryContent.clientWidth||this.temporaryContent.offsetWidth;c=(this.process.width>this.process.config.contentWidth)?true:false}else{this.temporaryContent.style.width=this.process.config.contentHeight+"px";this.temporaryContent.innerHTML=b;this.process.width=this.temporaryContent.scrollHeight||this.temporaryContent.clientHeight||this.temporaryContent.offsetHeight;c=(this.process.width>this.process.config.contentWidth)?true:false}}this.clipboard.className="";return c},getMultiColumnWidth:function(a){if(!this.temporaryContent){this.temporaryContent=document.createElement("div");this.clipboard.appendChild(this.temporaryContent)}var b=0;this.setTaketoriClassName(this.clipboard);this.setMultiColumnStyle(this.temporaryContent);this.temporaryContent.innerHTML=a;b=(this.isWritingModeReady)?this.getTotalHeight(this.temporaryContent):this.getTotalWidth(this.temporaryContent);this.clipboard.className="";return b},setMultiColumnStyle:function(a){a.className="taketori-col taketori-multi-column";a.style.overflow="auto";if(this.isWritingModeReady){a.style.width=this.process.config.width+"px";a.style.height=this.process.config.height+"px"}else{a.style.width=this.process.config.height+"px";a.style.height=this.process.config.width+"px"}a.style.MozColumnWidth=this.process.config.height+"px";a.style.webkitColumnWidth=this.process.config.height+"px";a.style.OColumnWidth=this.process.config.height+"px";a.style.msColumnWidth=this.process.config.height+"px";a.style.columnWidth=this.process.config.height+"px";a.style.MozColumnGap=this.process.config.gap+"px";a.style.webkitColumnGap=this.process.config.gap+"px";a.style.OColumnGap=this.process.config.gap+"px";a.style.msColumnGap=this.process.config.gap+"px";a.style.columnGap=this.process.config.gap+"px";a.style.MozColumnFill="auto";a.style.webkitColumnFill="auto";a.style.OColumnFill="auto";a.style.msColumnFill="auto";a.style.columnFill="auto"},setMultiColumnWidth:function(a){if(this.isWritingModeReady){var b=this.getTotalHeight(a);a.style.height=b+"px";a.style.overflow="visible";this.fixMargin(a,this.process.config.width,b)}else{var c=this.getTotalWidth(a);a.style.width=c+"px";a.style.overflow="visible";this.fixMargin(a,c,this.process.config.width)}},getTotalWidth:function(a){var b=a.scrollWidth||a.clientWidth||a.offsetWidth;return Math.ceil(b/(this.process.config.height+this.process.config.gap))*(this.process.config.height+this.process.config.gap)-this.process.config.gap},getTotalHeight:function(a){var b=a.scrollHeight||a.clientHeight||a.offsetHeight;return Math.ceil(b/(this.process.config.height+this.process.config.gap))*(this.process.config.height+this.process.config.gap)-this.process.config.gap},setTaketoriClassName:function(b){var a=(this.isWritingModeReady)?"taketori-writingmode-ttb":"taketori-ttb";if(this.rubyDisabled){a+=" taketori-ruby-disabled"}if(!this.isTextEmphasisReady){a+=" taketori-text-emphasis-disabled"}a+=((this.isWritingModeReady&&navigator.userAgent.search(/WebKit/i)!=-1&&navigator.userAgent.search(/Windows/i)!=-1)?" taketori-atsign":(!this.process.currentConfig.fontFamily)?" taketori-serif":(this.process.currentConfig.fontFamily=="sans-serif")?" taketori-sans-serif":(this.process.currentConfig.fontFamily=="cursive")?" taketori-cursive":(this.process.currentConfig.fontFamily=="kai")?" taketori-kai":" taketori-serif")+"-"+this.process.currentConfig.lang;a+=" taketori-lang-"+this.process.currentConfig.lang;b.className+=((b.className)?" ":"")+a},removeTaketoriClassName:function(a){this.document.element(a).removeClassName("taketori-ttb").removeClassName("taketori-writingmode-ttb").removeClassName("taketori-ruby-disabled").removeClassName("taketori-(lang|serif|sans-serif|cursive|kai)[\\w\\-]*")},make:function(b,a){this.document.element(b).addClassName("taketori-in-progress");var c=this;setTimeout(function(){if(!a){c.setCurrentConfig(b)}c.makeClipboard(b);c.parse(b,true);c.complement(b);c.removeClipboard();c.document.element(b).removeClassName("taketori-in-progress")},120)},isSkipClass:function(a){if(this.config.skipClass&&a.className){for(var b=0;b<this.config.skipClass.length;b++){var c=new RegExp("(^|\\s)"+this.config.skipClass[b]+"(?![\\w\\-])");if(this.elements.className.search(c)!=-1){return true}}}return false},isSkipId:function(a){return(this.config.skipId&&a.id&&this.isIncludedIn(this.config.skipId,thisNode.id))?true:false},parse:function(C,p){if(C==this.clipboard){return}if(C.taketori&&C.taketori.ttb){this.toggle(C,true,true)}var y=C.nodeName.toLowerCase();var u="";var h="";var e="";var k="";var f="";var A="";var o=false;var t=C.nodeType;var q=null;var g=false;var m=C.hasChildNodes&&C.hasChildNodes();switch(t){case 1:var s=this.getStyle(C);if(this.process.isBreakable){var l=this.getFontSize(s.fontSize);this.process.lineHeight=this.toPx(s.lineHeight,l,true);if(!this.process.lineLength){this.process.lineLength=this.process.config.height}if(!p&&s.display=="block"){var v=this.process.lineLength;this.process.lineLength-=this.getMarginSize([s.marginTop,s.marginBottom,s.paddingTop,s.paddingBottom,s.borderTopWidth,s.borderBottomWidth]);if(this.process.lineLength<l){this.process.lineLength=l}}this.process.roughFormula=l*this.process.lineHeight/this.process.lineLength}if(!p){if(this.isIncludedIn(["img","object","embed","video","audio","textarea"],y)){this.appendHTML(this.counterClockwiseRotatedOuterHTML(C,s));return}else{if(this.isSkipClass(C)||this.isSkipId(C)){this.appendHTML(this.counterClockwiseRotatedOuterHTML(C,s));return}else{if(this.isIncludedIn(["link","meta","base","script","style","map"],y)){this.process.columnHTML+=this.outerHTML(C);return}else{if(y=="!"){return}else{if(this.isIncludedIn(["br","input","select","option"],y)||(this.isMSIE&&this.isMSIE<8&&y=="table")){this.appendHTML(this.outerHTML(C));return}}}}}var c=C.attributes;var x=false;var w=false;for(var n=0;n<c.length;n++){var a=c[n];var b=a.nodeName.toLowerCase();var d=(typeof a.nodeValue=="string"||typeof a.nodeValue=="number")?this.escapeHTML(a.nodeValue):(b=="style"&&C.style.cssText!=null)?C.style.cssText.replace(/[\w\-]+:/g,function(i){return i.toLowerCase()}):(b=="class"&&C.className!=null)?C.className:null;if(!a.specified||!d||this.isIncludedIn(this.stripAttributes,b)){continue}switch(b){case"style":k=d;d="";break;case"class":f+=((f)?" ":"")+d;if(d.search(/(^|\s)ltr(?![\w\-])/)!=-1){if(!this.process.ltr){x=true}this.process.ltr=true}d="";break;case"dir":if(d.search(/(^|\s)ltr(?![\w\-])/)!=-1){if(!this.process.ltr){x=true}this.process.ltr=true}f+=((f)?" ":"")+d;break}if(d!=null&&d!=""){e+=" "+b+'="'+d+'"'}}if(x){k+=this.counterClockwiseRotatedOuterHTML(C,s,true)}else{if(this.isWritingModeReady&&!this.isIncludedIn(["table","caption","thead","tbody","tr","td","th","tfoot"],y)){k+=this.counterClockwiseRotatedOuterHTML(C,s,true)}}if(!this.process.ltr&&(!this.isMSIE||this.isMSIE>7)){if(y=="li"&&this.process.listStyleType&&this.process.listStyleType[this.process.listStyleType.length-1]!=""){e+=' data-marker="'+this.getListMarkerText()+'"'}if(y=="ul"||y=="ol"){o=true;this.process.listStart[this.process.listStart.length]=0;var r=s.listStyleType.toLowerCase();if(this.isIncludedIn(["none","disc","circle","square"],r)){this.process.listStyleType[this.process.listStyleType.length]=""}else{this.process.listStyleType[this.process.listStyleType.length]=r;f+=((f)?" ":"")+"cjk"}}if(this.isWritingModeReady){if(y=="strong"){if(!this.isTextEmphasisReady){if(!this.process.kenten){w=true}this.process.kenten=true}f+=((f)?" ":"")+"bo-ten"}}if(!this.isWritingModeReady&&s.fontStyle&&s.fontStyle.toLowerCase()=="italic"&&m){f+=((f)?" ":"")+"italic"}if(s.textDecoration&&m){var B=s.textDecoration.toLowerCase();if(B!="none"){if(B.search(/underline/i)!=-1&&B.search(/overline/i)!=-1){f+=((f)?" ":"")+"bothline";q=this.lineMarginHeight(s)}else{if(B.search(/underline/i)!=-1){f+=((f)?" ":"")+"underline";q=this.lineMarginHeight(s)}else{if(B.search(/overline/i)!=-1){f+=((f)?" ":"")+"overline";q=this.lineMarginHeight(s)}}}if(!this.isWritingModeReady&&q){if(!this.process.lineMarginHeight){g=true}this.process.lineMarginHeight=q}}}}if(f){e+=' class="'+f+'"'}if(k){e+=' style="'+k+'"'}if(!p){u+="<"+y+e}}if(!m){if(!p){u+="></"+y+">";this.process.columnHTML+=u}}else{if(!p){this.process.columnHTML+=u+">";if(o){u+=' start=""'}u+=">";h="</"+y+">";this.process.openTags[this.process.openTags.length]=u;this.process.closeTags[this.process.closeTags.length]=y}for(var n=0;n<C.childNodes.length;n++){this.parse(C.childNodes[n])}if(!p){this.process.columnHTML+=h;this.process.openTags.pop();this.process.closeTags.pop();if(x){this.process.ltr=null}if(w){this.process.kenten=null}if(g){this.process.lineMarginHeight=null}if(o){this.process.listStart.pop();this.process.listStyleType.pop()}}}if(v){this.process.lineLength=v}break;case 3:A=this.escapeHTML(C.nodeValue);A=A.replace(/\uFF0F\uFF3C/g,"\u3033\u3035").replace(/\uFF3C\uFF0F/g,"\u3033\u3035").replace(/\uFF0F\u0022\uFF3C/g,"\u3034\u3035").replace(/\uFF3C\u0022\uFF0F/g,"\u3034\u3035");var z=this;var j=0;A.replace(/&#?\w+;|\s+|./g,function(i){if(i.search(/^[\u1100-\u11FF\u2030-\u217F\u2460-\u24FF\u2600-\u261B\u2620-\u277F\u2E80-\u2FDF\u2FF0-\u4DBF\u4E00-\u9FFF\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\uF900-\uFAFF\uFE30-\uFE4F\uFF00\uFF01\uFF03-\uFF06\uFF08-\uFF0C\uFF0E-\uFF1B\uFF1F-\uFF3D\uFF40-\uFF5B\uFF5D-\uFFEF]$/)!=-1){z.setCJK();if(z.process.currentConfig.zh&&z.isWritingModeReady&&!z.process.ltr&&(i=="\uFF1A"||i=="\uFF1B")){i='<span class="tcy">'+i+"</span>"}else{if((!z.isWritingModeReady||z.process.kenten)&&!z.process.ltr){i=z.kinsokuShori("<span"+((!z.process.ltr)?' class="'+z.getCJKClassName(i)+'"':"")+((!z.process.ltr&&z.process.lineMarginHeight)?' style="margin-top:'+z.process.lineMarginHeight+"px;margin-bottom:"+z.process.lineMarginHeight+'px;"':"")+">"+i+"</span>")}}j++}else{if(i.search(/^\s+$/)!=-1){if(j>0){j+=0.5}}else{if(i.search(/^[0-9a-zA-Z]$/)!=-1){j+=0.5;z.process.latin++}else{j++;z.process.latin=0}if(z.process.noCJK==0){i='<span class="nocjk notcy">'+i}if(!this.isTextEmphasisReady){z.process.noCJK++}}}if(!z.process.isBreakable||(j>1&&z.isNoBreak(z.process.width+(j*z.process.roughFormula)+z.process.lineHeight))){z.process.columnHTML+=i}else{j=1;z.appendHTML(i)}});this.setCJK();break}},isNoBreak:function(a){if(this.isWritingModeReady||!this.process.isMultiColumnEnabled){return(a<this.process.config.width)?true:false}else{if(this.process.config.contentHeight&&this.process.config.contentWidth){if(this.process.config.columnCount&&this.process.config.columnCount>1){return(a+50<this.process.config.width*this.process.config.columnCount)?true:false}else{return(a<this.process.config.contentHeight)?true:false}}else{return true}}},setCJK:function(){if(this.process.noCJK>0){this.process.columnHTML=((this.process.noCJK==this.process.latin&&this.process.latin<=2)?this.process.columnHTML.replace('<span class="nocjk notcy">','<span class="tcy">'):this.process.columnHTML.replace('<span class="nocjk notcy">','<span class="nocjk">'))+"</span>"}this.process.latin=this.process.noCJK=0},lineMarginHeight:function(c){var b=c.lineHeight;var a=this.getFontSize(c.fontSize);if(b.search(/\d+px/)!=-1){return parseInt((parseInt(b)-a)/2)}else{return parseInt((parseFloat(b)*a-a)/2)}},getListMarkerText:function(){var c=++this.process.listStart[this.process.listStart.length-1];var b=this.process.listStyleType[this.process.listStyleType.length-1];var a;if(b=="A"||b=="\u30A2"||b=="upper-latin"||b=="katakana"){a=["\u30A2","\u30A2","\u30A4","\u30A6","\u30A8","\u30AA","\u30AB","\u30AD","\u30AF","\u30B1","\u30B3","\u30B5","\u30B7","\u30B9","\u30BB","\u30BD","\u30BF","\u30C1","\u30C4","\u30C6","\u30C8","\u30CA","\u30CB","\u30CC","\u30CD","\u30CE","\u30CF","\u30D2","\u30D5","\u30D8","\u30DB","\u30DE","\u30DF","\u30E0","\u30E1","\u30E2","\u30E4","\u30E6","\u30E8","\u30E9","\u30EA","\u30EB","\u30EC","\u30ED","\u30EF","\u30F0","\u30F1","\u30F2","\u30F3"];return"("+a[c]+")"}else{if(b=="a"||b=="\u3042"||b=="lower-latin"||b=="hiragana"){a=["\u3042","\u3042","\u3044","\u3046","\u3048","\u304A","\u304B","\u304D","\u304F","\u3051","\u3053","\u3055","\u3057","\u3059","\u305B","\u305D","\u305F","\u3061","\u3064","\u3066","\u3068","\u306A","\u306B","\u306C","\u306D","\u306E","\u306F","\u3072","\u3075","\u3078","\u307B","\u307E","\u307F","\u3080","\u3081","\u3082","\u3084","\u3086","\u3088","\u3089","\u308A","\u308B","\u308C","\u308D","\u308F","\u3090","\u3091","\u3092","\u3093"];return"("+a[c]+")"}else{if(b=="\u30A4"||b=="katakana-iroha"){a=["\u30A4","\u30A4","\u30ED","\u30CF","\u30CB","\u30DB","\u30D8","\u30C8","\u30C1","\u30EA","\u30CC","\u30EB","\u30F2","\u30EF","\u30AB","\u30E8","\u30BF","\u30EC","\u30BD","\u30C4","\u30CD","\u30CA","\u30E9","\u30E0","\u30A6","\u30F0","\u30CE","\u30AA","\u30AF","\u30E4","\u30DE","\u30B1","\u30D5","\u30B3","\u30A8","\u30C6","\u30A2","\u30B5","\u30AD","\u30E6","\u30E1","\u30DF","\u30B7","\u30F1","\u30D2","\u30E2","\u30BB","\u30B9"];return"("+a[c]+")"}else{if(b=="\u3044"||b=="hiragana-iroha"){a=["\u3044","\u3044","\u308D","\u306F","\u306B","\u307B","\u3078","\u3068","\u3061","\u308A","\u306C","\u308B","\u3092","\u308F","\u304B","\u3088","\u305F","\u308C","\u305D","\u3064","\u306D","\u306A","\u3089","\u3080","\u3046","\u3090","\u306E","\u304A","\u304F","\u3084","\u307E","\u3051","\u3075","\u3053","\u3048","\u3066","\u3042","\u3055","\u304D","\u3086","\u3081","\u307F","\u3057","\u3091","\u3072","\u3082","\u305B","\u3059"];return"("+a[c]+")"}else{if(b=="I"||b=="upper-roman"){a=["I","I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX"];return"("+a[c]+")"}else{if(b=="i"||b=="lower-roman"){a=["i","i","ii","iii","iv","v","vi","vii","viii","ix","x","xi","xii","xiii","xiv","xv","xvi","xvii","xviii","xix","xx"];return"("+a[c]+")"}else{if(b=="1"||b=="decimal"||b=="\u4E00"||b=="cjk-ideographic"||b=="\u58F1"){if(c<=10){a=(b=="\u58F1")?["\u58F1","\u58F1","\u5F10","\u53C2","\u56DB","\u4F0D","\u516D","\u4E03","\u516B","\u4E5D","\u62FE"]:["\u4E00","\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341"];return"("+a[c]+")"}else{return"("+c+")"}}else{return""}}}}}}}},appendHTML:function(c,b){var a="";if(c==null){c=""}if((b||this.process.isBreakable)&&this.process.columnHTML!=""){if((this.isWritingModeReady&&!this.isMultiColumnReady)||!this.process.isMultiColumnEnabled){if(b){a=this.columnComplement()}else{a=this.columnComplement(this.process.columnHTML+c)}if(b||this.process.config.width<this.getWidth(a)){if(!b){a=this.columnComplement()}this.process.content+='<div class="taketori-col" style="'+this.rotatedBlockAdditionalCSSText(this.process.config.height,this.process.config.width,this.process.config.gap,this.process.config.multiColumnEnabled)+'">'+a+"</div>";this.process.columnCount++;if(b||(this.process.config.columnCount&&this.process.config.columnCount==this.process.columnCount)){this.containerBreak()}}}else{if(this.process.config.contentHeight&&this.process.config.contentWidth){if(b){a=this.columnComplement()}else{a=this.columnComplement(this.process.columnHTML+c)}if(b||this.hasToBreak(a)){if(!b){a=this.columnComplement()}if(this.process.config.columnCount&&this.process.config.columnCount>1){this.process.content+='<div class="taketori-col taketori-multi-column" style="-moz-column-width:'+this.process.config.height+"px;-webkit-column-width:"+this.process.config.height+"px;column-width:"+this.process.config.height+"px;-moz-column-count:"+this.process.config.columnCount+";-webkit-column-count:"+this.process.config.columnCount+";column-count:"+this.process.config.columnCount+";-moz-column-gap:"+this.process.config.gap+"px;-webkit-column-gap:"+this.process.config.gap+"px;column-gap:"+this.process.config.gap+"px;"+this.rotatedBlockAdditionalCSSText(this.process.config.contentHeight,this.process.config.contentWidth,0,true)+'">'+a+"</div>"}else{this.process.content+='<div class="taketori-col" style="'+this.rotatedBlockAdditionalCSSText(this.process.config.contentHeight,this.process.config.contentWidth)+'">'+a+"</div>"}this.containerBreak()}}else{if(b){this.process.content=document.createElement("div");this.setMultiColumnStyle(this.process.content);this.process.content.innerHTML=this.columnComplement();this.containerBreak();this.setMultiColumnWidth(this.process.target.firstChild)}}}}this.process.columnHTML+=c},columnComplement:function(c){var g=false;var d="";if(c==null){d=this.process.columnHTML+((this.process.noCJK>1)?"</span>":"");g=true}else{d=c+((this.process.noCJK)?"</span>":"")}if(g){this.process.columnHTML="";this.process.width=0;if(this.process.noCJK){this.process.noCJK=1}if(this.process.latin){this.process.latin=1}}var b="";var h=this.process.openTagsHTML;var f=true;for(var e=this.process.closeTags.length-1;e>=0;e--){var a=this.process.closeTags[e];var j=new RegExp("<"+a+"(?!\\w)[^>]*>\\s*$");if(d.search(j)==-1){b+="</"+a+">"}else{if(b==""){d=d.replace(j,"");if(a=="li"){f=false}}}}if(g){this.process.openTagsHTML=this.process.openTags.join("");if(f){this.process.openTagsHTML=this.process.openTagsHTML.replace(/ data-marker=".*?"/g,"")}for(var e=0;e<this.process.listStart.length;e++){this.process.openTagsHTML=this.process.openTagsHTML.replace(/ start=""/,'start="'+this.process.listStart[e]+'"')}}return h+d+b},getCJKClassName:function(b){var a;if(b=="\u30FC"||b=="\u301C"||b=="\uFF5E"||b=="\u2026"){this.process.kinsoku=true;return"cjk cho-on"}else{if(b=="\u3001"||b=="\uFF0C"){this.process.kinsoku=true;return(this.process.currentConfig.ja)?"cjk tou-ten":"cjk"}else{if(b=="\u3002"||b=="\uFF0E"){this.process.kinsoku=true;return(this.process.currentConfig.ja)?"cjk ku-ten":"cjk"}else{if(b.search(/^[\u3041\u3043\u3045\u3047\u3049\u3083\u3085\u3087\u3063\u30A1\u30A3\u30A5\u30A7\u30A9\u30E3\u30E5\u30E7\u30C3]$/)!=-1){this.process.kinsoku=true;return"cjk kogaki"}else{if(b.search(/^[\u3009\u300B\u300D\u300F\u3011\u3015\u3017\u3019\uFF09\uFF5D\uFF60]$/)!=-1){this.process.kinsoku=true;return"kakko"}else{if(b.search(/^[\u3008\u300A\u300C\u300E\u3010\u3014\u3016\u3018\uFF08\uFF5B\uFF5F]$/)!=-1){return"kakko"}else{if(b.search(/^[\uFF01\uFF1A\uFF1B\uFF1F]$/)!=-1){this.process.kinsoku=true;return"cjk"}else{return"cjk"}}}}}}}},kinsokuShori:function(a){if(this.process.kinsoku){this.process.columnHTML=this.process.columnHTML.replace(/(<span(?!\w)[^>]*class="cjk"[^>]*>.<\/span>)$/,"");if(RegExp.$1){a='<span class="kinsoku">'+RegExp.$1+a+"</span>"}this.process.kinsoku=null}return a},complement:function(a){this.appendHTML("",true)},containerBreak:function(){if(typeof this.process.config.onbreak=="function"){this.process.config.onbreak(this)}else{this._containerBreak()}},_containerBreak:function(){if(this.process.target){this.removeClipboard();if(!this.process.target.taketori){this.process.target.taketori={}}if(!this.process.config.contentWidth||!this.process.config.contentHeight||!this.process.done){var a=this.process.target.innerHTML;this.setTaketoriClassName(this.process.target);if(typeof this.process.content=="object"){this.process.target.innerHTML="";this.process.target.appendChild(this.process.content)}else{this.process.target.innerHTML=this.process.content;var b=this.process.target.firstChild;var e=this;var d=this.process.config.width;var c=this.process.config.gap;setTimeout(function(){if(e.isWritingModeReady){if(b.clientHeight<b.scrollHeight){b.style.height=b.scrollHeight+"px"}}else{if(b.clientWidth<b.scrollWidth){var f=b.scrollWidth;b.style.width=f+"px";e.fixMargin(b,f,d,c,e.process.config.multiColumnEnabled)}}},600)}if(this.process.config.contentWidth&&this.process.config.contentHeight){this.process.done=true}this.process.content="";this.process.target.taketori.ttb=true;this.process.target.taketori.alt=a;this.process.target.taketori.config=this.configClone(this.process.currentConfig);this.process.target.taketori.clientWidth=this.process.target.clientWidth;this.process.target.taketori.windowHeight=this.windowHeight}this.makeClipboard(this.process.target)}},fixMargin:function(d,e,b,a,c){if(!a){a=0}if(this.isWritingModeReady){if(a){if(!c){d.style.paddingBottom=a+"px"}else{d.style.marginBottom=a+"px"}}}else{d.style.marginTop="-"+b+"px";d.style.marginRight=(b-e-a)+"px";d.style.marginBottom=(e+a)+"px";d.style.marginLeft=0;if(!c&&a){d.style.paddingRight=a+"px"}}},refresh:function(){if(this.isLegacy){return this}this.init();for(var c=0;c<this.targetElements.length;c++){var b=this.targetElements[c];if(b&&b.taketori&&b.taketori.alt&&b.taketori.ttb&&(b.clientWidth!=b.taketori.clientWidth||b.taketori.windowHeight!=this.windowHeight)){this.setCurrentConfig(b,b.taketori.config);if(this.process.isBreakable){this.toggle(b,true,true);this.make(b,true)}else{var a=b.firstChild;var d;if(a){if(this.process.isMultiColumnEnabled){a.style.overflow="auto"}if(b.clientWidth!=b.taketori.clientWidth){b.taketori.clientWidth=b.clientWidth;if(this.isWritingModeReady){a.style.width=this.process.config.width+"px"}else{a.style.height=this.process.config.width+"px"}}if(b.taketori.windowHeight!=this.windowHeight){if(this.process.isMultiColumnEnabled){d=this.process.config.height;a.style.MozColumnWidth=d+"px";a.style.webkitColumnWidth=d+"px";a.style.OColumnWidth=d+"px";a.style.msColumnWidth=d+"px";a.style.columnWidth=d+"px"}else{if(this.isWritingModeReady){a.style.height=this.process.config.height+"px";if(a.clientHeight<a.scrollHeight){a.style.height=a.scrollHeight+"px"}}else{d=this.process.config.height;a.style.width=d+"px";if(a.clientWidth<a.scrollWidth){d=a.scrollWidth;a.style.width=d+"px"}}}b.taketori.windowHeight=this.windowHeight}if(this.process.isMultiColumnEnabled){if(this.isWritingModeReady){a.style.height=this.process.config.height+"px"}else{a.style.width=this.process.config.height+"px"}this.setMultiColumnWidth(a)}else{if(!this.isWritingModeReady){this.fixMargin(a,d,this.process.config.width,this.process.config.gap,this.process.config.multiColumnEnabled)}}}}}}},toggle:function(c,e,d,b){if(this.isLegacy||this.isVerticalTextElement(c)||(e!=null&&((e&&(!c.taketori||!c.taketori.ttb))||((!e&&c.taketori&&c.taketori.ttb))))){return this}this.init();if(c.taketori&&c.taketori.alt&&(c.taketori.ttb||(c.clientWidth==c.taketori.clientWidth&&c.taketori.windowHeight==this.windowHeight))){var a=c.innerHTML;c.innerHTML=c.taketori.alt;if(c.taketori.ttb){this.removeTaketoriClassName(c)}else{this.setTaketoriClassName(c);d=true}if(d){c.taketori.alt=((b||this.config.cacheDisabled)&&c.taketori.ttb)?null:a;c.taketori.ttb=(c.taketori.ttb)?false:true;c.taketori.clientWidth=c.clientWidth;c.taketori.windowHeight=this.windowHeight}else{this.removeTarget(c);c.taketori=null}}else{this.appendTarget(c);this.make(c,false)}return this},clear:function(a){this.toggle(a,true,true,true)}};